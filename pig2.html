modify from weichia2005
